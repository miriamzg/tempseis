
		Receiver Function Inversion (RFI) 

	plot and synthetic receiver function programs

	Written originally by T. Shibutani, ERI, JAPAN.
	(with some minor modifications by M. Sambridge, RSES, ANU)

Several input and output files are used by the RFI subroutines.
The routine user_init reads RFI specific input files and the 
routine writemodels writes out a series of files that can be used 
for plotting.

RFI input files:

rfi.in - contains top level information on RFI problem.
	 e.g. names of files, number and type of input data etc.

NA_MDL/`*****' - (Exact name specified in rfi.in. e.g. `V6.10D') 
		  Contains parameter space bounds and other model information.

NA_ORF/`*****' - (Exact name specified in rfi.in. e.g. `SYN.V6D.A35.N25.syn') 
		  Contains observed or synthetic input receiver function
		  in SAC format. (Note that for a synthetic test, synthetic 
                  RF(s) computed using the procedure below should be copied 
		  from "NA_SRF" to "NA_ORF.) 

RFI output files:

NA_MDL/`*****' - (Exact name specified in rfi.in. e.g. `SYN3_V6D.N25.NA')
		  Contains all models at each iteration in ascii format.

			Plot programs

The following describes the use of RFI specific postscript
plot programs. Note the programs splot-x splot-p can also be used 
to produce generic plots of the model space samples produced by 
the NA algorithm. 

This description is not intended to be comprehensive please run 
the examples and examine the source code for full details of these
plot programs.

Installation:
 
Installation is performed as part of the `make all' in the 
NA top level src directory.  To install the plot and synthetic receiver 
function generation programs explicitly

cd Demo/src/rfi_subs/rfi_plot
make all

This will put the following executables in Demo/bin

plot_model - produces density plot of 1-D velocity profiles 
	     generated by rfi_na (postscript only)

plot_rf-x  - plots observed and best fit receiver functions (X) 

plot_rf-p  - plots observed and best fit receiver functions (postscript) 
 
synrf      - calculates a receiver function from an input velocity profile
	     (can be used to generate synthetic data for rfi_na)

synrf_noise  - calculates a receiver function from an input velocity profile
	       with correlated random noise added.
	       (can be used to generate synthetic data for rfi_na)

Each of these programs are run using a script and various input files.
An example of each is described below:

To draw a density figure of models produced by rfi_na:

  cd to directory rfi_plot 

  Run script "run_plot_model" for a color figure of NAD file
  in Demo/data.

  Run script "run_plot_modelbw" for a B&W figure of NAD file
  in Demo/data.
	
  Run script "run_plot_model_demo" for a density plot of the NAD
  file included in Demo/data/results 

  Run script "run_plot_modelbw_demo" for a density plot of the NAD
  file included in Demo/data/results

  Both scripts run the program plot_model.f and use the files
  PS_utl/frame.in and PS_utl/pal.in to control frame and colour
  pallette of the figure. Plot features can be changed by editing 
  these files or the scripts.

	Note: The programs will overlay a reference model if one
	      exists in the file `NA_MDL/model_ref'. 

To plot the observed and/or the predicted receiver function of the
best data fitting model: 

  cd to directory rfi_plot 

  run plot_rf-x_run for an X-graphics figure (NB close netscape first!)

  run plot_rf-p_run for a postscript figure

  Both scripts run the program plot_rf.f and use the files
  PS_utl/frame.in and PS_utl/pal.in to control frame and colour
  pallette of the figure. Plot features can be changed by editing 
  these files or the scripts.

	Note: this program uses the text in file `text' to display on 
	      top of the plot. 

To compute synthetic receiver functions:

  "synrf_run" for noise-free RF.

  "synns_run" for noise-added RF.

  An input model (eg. SYN3_V14.10) should be in "NA_MDL".
  A synthetic RF will be output into "NA_SRF" 
  (e.g. SYN3.A01.N01.syn).

